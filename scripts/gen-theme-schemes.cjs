// Generates theme-schemes.css from Material Color Utilities
// Run: node scripts/gen-theme-schemes.cjs > packages/ui/src/styles/theme-schemes.css

const {
  argbFromHex,
  hexFromArgb,
  Hct,
  MaterialDynamicColors,
  SchemeContent,
} = require('@material/material-color-utilities');

const seeds = {
  green:  '#00a76f',
  purple: '#7635dc',
  blue:   '#078dee',
  pink:   '#d63c78',
  orange: '#fda92d',
  red:    '#ff3030',
};

const tokens = [
  ['background',               MaterialDynamicColors.background],
  ['on-background',            MaterialDynamicColors.onBackground],
  ['surface',                  MaterialDynamicColors.surface],
  ['surface-dim',              MaterialDynamicColors.surfaceDim],
  ['surface-bright',           MaterialDynamicColors.surfaceBright],
  ['surface-container-lowest', MaterialDynamicColors.surfaceContainerLowest],
  ['surface-container-low',    MaterialDynamicColors.surfaceContainerLow],
  ['surface-container',        MaterialDynamicColors.surfaceContainer],
  ['surface-container-high',   MaterialDynamicColors.surfaceContainerHigh],
  ['surface-container-highest',MaterialDynamicColors.surfaceContainerHighest],
  ['surface-variant',          MaterialDynamicColors.surfaceVariant],
  ['on-surface',               MaterialDynamicColors.onSurface],
  ['on-surface-variant',       MaterialDynamicColors.onSurfaceVariant],
  ['inverse-surface',          MaterialDynamicColors.inverseSurface],
  ['inverse-on-surface',       MaterialDynamicColors.inverseOnSurface],
  ['outline',                  MaterialDynamicColors.outline],
  ['outline-variant',          MaterialDynamicColors.outlineVariant],
  ['shadow',                   MaterialDynamicColors.shadow],
  ['scrim',                    MaterialDynamicColors.scrim],
  ['primary',                  MaterialDynamicColors.primary],
  ['on-primary',               MaterialDynamicColors.onPrimary],
  ['primary-container',        MaterialDynamicColors.primaryContainer],
  ['on-primary-container',     MaterialDynamicColors.onPrimaryContainer],
  ['inverse-primary',          MaterialDynamicColors.inversePrimary],
  ['secondary',                MaterialDynamicColors.secondary],
  ['on-secondary',             MaterialDynamicColors.onSecondary],
  ['secondary-container',      MaterialDynamicColors.secondaryContainer],
  ['on-secondary-container',   MaterialDynamicColors.onSecondaryContainer],
  ['tertiary',                 MaterialDynamicColors.tertiary],
  ['on-tertiary',              MaterialDynamicColors.onTertiary],
  ['tertiary-container',       MaterialDynamicColors.tertiaryContainer],
  ['on-tertiary-container',    MaterialDynamicColors.onTertiaryContainer],
  ['error',                    MaterialDynamicColors.error],
  ['on-error',                 MaterialDynamicColors.onError],
  ['error-container',          MaterialDynamicColors.errorContainer],
  ['on-error-container',       MaterialDynamicColors.onErrorContainer],
];

// md-sys aliases (just the most-needed subset)
const aliases = [
  'background','on-background','surface','on-surface','surface-variant',
  'on-surface-variant','primary','on-primary','primary-container',
  'on-primary-container','secondary','on-secondary','secondary-container',
  'on-secondary-container','tertiary','on-tertiary','tertiary-container',
  'on-tertiary-container','error','on-error','error-container',
  'on-error-container','outline','outline-variant','inverse-surface',
  'inverse-on-surface','inverse-primary',
];

const schemeLabel = {
  green:  'GREEN / COBALT  — seed #00a76f',
  purple: 'PURPLE / PLUM   — seed #7635dc',
  blue:   'BLUE / TEAL     — seed #078dee',
  pink:   'PINK / CORAL    — seed #d63c78',
  orange: 'ORANGE / GOLD   — seed #fda92d',
  red:    'RED / CYAN      — seed #ff3030',
};

let out = `/* =====================================================================
   THEME SCHEMES — Complete M3 system color tokens
   Auto-generated by scripts/gen-theme-schemes.cjs
   Source: @material/material-color-utilities SchemeContent (contrast 0)

   INDUSTRY-STANDARD APPROACH:
   - Set data-theme="scheme" and data-mode="light|dark" on <html>.
   - CSS handles everything. Zero JavaScript inline style manipulation.
   - Blocking <script> in <head> sets the attributes before first paint.
   - ThemeProvider only manages the HTML attributes reactively.

   Selector specificity: html[attr][attr] (0-2-1) beats :root (0-1-0)
   so these always win over the base tokens in :root.
   ===================================================================== */\n`;

for (const [name, seed] of Object.entries(seeds)) {
  out += `\n/* ${'─'.repeat(60)}\n   ${schemeLabel[name]}\n   ${'─'.repeat(60)} */\n`;

  for (const dark of [false, true]) {
    const mode = dark ? 'dark' : 'light';
    const scheme = new SchemeContent(Hct.fromInt(argbFromHex(seed)), dark, 0);
    out += `\nhtml[data-theme="${name}"][data-mode="${mode}"] {\n`;

    // Core tokens
    for (const [cssName, dc] of tokens) {
      const hex = hexFromArgb(dc.getArgb(scheme));
      out += `  --m3-color-${cssName}: ${hex};\n`;

      // Inject on-surface-rgb helper right after on-surface
      if (cssName === 'on-surface') {
        const argb = dc.getArgb(scheme);
        const r = (argb >> 16) & 0xff;
        const g = (argb >> 8) & 0xff;
        const b = argb & 0xff;
        out += `  --m3-color-on-surface-rgb: ${r}, ${g}, ${b};\n`;
      }
    }

    // md-sys aliases
    out += `  /* md-sys aliases */\n`;
    for (const alias of aliases) {
      out += `  --md-sys-color-${alias}: var(--m3-color-${alias});\n`;
    }

    out += `}\n`;
  }
}

// Dark-mode non-scheme UI vars (glass, divider etc.) stay in theme-base.css
// and are NOT repeated here.

process.stdout.write(out);
